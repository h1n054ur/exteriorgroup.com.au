# Cloudflare Workers Configuration
# exteriorgroup.com.au - Edge-native Hono application

name = "exteriorgroup"
main = "src/index.tsx"
compatibility_date = "2026-01-16"
compatibility_flags = ["nodejs_compat"]

# Static assets directory
[assets]
directory = "public"
run_worker_first = ["/api/*", "/admin/*"]

# D1 Database binding (ID will be set after provisioning)
[[d1_databases]]
binding = "DB"
database_name = "exterior-group-db"
database_id = "9f97c937-ad90-44a5-b24c-02e455fe0301"
migrations_dir = "db/migrations"

# R2 Storage binding (for project images and media)
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "exterior-group-assets"

# Environment variables (non-secrets)
# Secrets added via: wrangler secret put SECRET_NAME
[vars]
SITE_NAME = "Exterior Group"

# =============================================================================
# STAGING ENVIRONMENT (for preview deployments)
# =============================================================================
[env.staging]
name = "exteriorgroup-staging"
vars = { SITE_NAME = "Exterior Group (Staging)" }

# Use same D1 database for staging (or create a separate one)
[[env.staging.d1_databases]]
binding = "DB"
database_name = "exterior-group-db"
database_id = "9f97c937-ad90-44a5-b24c-02e455fe0301"

# Use same R2 bucket for staging
[[env.staging.r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "exterior-group-assets"
